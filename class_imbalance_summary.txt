â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            CLASS IMBALANCE ISSUE - DIAGNOSIS & FIX             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ” THE PROBLEM
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Your dataset has severe class imbalance:

  Background pixels:  99.63%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  Lesion pixels:       0.37%  â–
  
  Ratio: 1:270 (270 background pixels per lesion pixel!)

ðŸ¤” WHY ACCURACY IS MISLEADING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
The model can achieve 99.6% accuracy by predicting "no lesion"
everywhere - it's doing NOTHING useful!

  Ground Truth:     [0,0,0,1,0,0,0,0,0,0]  (10% lesions)
  Lazy Prediction:  [0,0,0,0,0,0,0,0,0,0]  (0% lesions)
  
  Accuracy: 90%! âœ“ But it MISSED the lesion! âœ—

âœ… THE FIX - NOW IMPLEMENTED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. âœ… Added Focal Loss
   - Down-weights easy examples (abundant background)
   - Focuses on hard examples (rare lesions)
   
2. âœ… Added Weighted Combined Loss
   - Focal Loss + Dice Loss
   - Now the DEFAULT in config.py
   
3. âœ… Better metrics to monitor
   - Focus on Dice, IoU, Sensitivity
   - Ignore misleading accuracy

ðŸ“Š WHAT TO MONITOR NOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ DON'T watch:
  - Pixel Accuracy (always ~99%, meaningless)

âœ… DO watch:
  - Dice Coefficient  (target: > 0.6)
  - IoU               (target: > 0.5)
  - Sensitivity       (target: > 0.7)
  - Visual results    (predictions should show lesions!)

ðŸš€ HOW TO USE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Config is already updated! Just train:

  python main.py --mode train --epochs 50

Then evaluate:

  python main.py --mode evaluate

ðŸ“ˆ EXPECTED IMPROVEMENT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Old Loss (BCE + Dice):
  Dice: ~0.05          âœ— Model predicts mostly zeros
  Sensitivity: ~0.02   âœ— Misses 98% of lesions
  
New Loss (Focal + Dice):
  Dice: ~0.60-0.70     âœ“ Good detection
  Sensitivity: ~0.70+  âœ“ Finds most lesions
  IoU: ~0.50-0.60      âœ“ Reasonable overlap

ðŸ“š DOCUMENTATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

See CLASS_IMBALANCE_GUIDE.md for detailed explanation and
advanced techniques.

âœ¨ YOU'RE READY TO TRAIN WITH THE FIX!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  python main.py --mode train

Monitor Dice coefficient - it should improve from ~0 to >0.6!

